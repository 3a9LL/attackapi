<?xml version="1.0" encoding="UTF-8"?> 
<Module>
	<ModulePrefs title="API Documentation"/> 
	<Content type="html">
		<![CDATA[ 
			<div id="content__MODULE_ID__">
				<p class="scaffold">The following module will allow you to explore AttackAPI API documentation.</p>
				<div class="scaffold"><ul id="navigation__MODULE_ID__"></ul></div>
				<div id="cats__MODULE_ID__" class="scaffold"></div>
				<style>
					#navigation__MODULE_ID__ {
					margin: 0;
					padding: 0;
					list-style-type: none;
					}

					#navigation__MODULE_ID__ li {
					display: inline;
					margin-right: 10px;
					}

					#cats__MODULE_ID__ h3 {
					font-size: 200%;
					margin-bottom: 0.2em;
					}
				</style>
				<script>
					$.ajax({
						method: 'GET',
						url: '__MODULE_BASE__/../data/doc.json',

						success: function (data) {
							eval("window['data__MODULE_ID__'] = " + data + ";");

							var cats = {};
							var last_cat = '';

							for (var i = 0; i < window['data__MODULE_ID__'].length; i++) {
								var item = window['data__MODULE_ID__'][i];


								if (last_cat != item.cat && !cats[item.cat]) {
									$('<div id="cat_' + item.cat + '" class="cat"><h3>' + item.cat + '</h3><div class="cat-content"></div></div>').appendTo('#cats__MODULE_ID__').hide();
								}

								$('<p><strong>' + item.name + '</strong> - ' + item.short + '</p>').appendTo('#cats__MODULE_ID__ #cat_' + item.cat);

								cats[item.cat] = true;
								last_cat = item.cat;
							}

							$('#cats__MODULE_ID__ .cat:first-child').show();

							// what a bug!!?!
							$('#navigation__MODULE_ID__').hide();

							for (var cat in cats) {
								$('<li><a href="#cat_' + cat + '">' + cat + '</a></li>').appendTo('#navigation__MODULE_ID__').children('a').click(function () {
									$('#cats__MODULE_ID__ .cat:visible').hide();
									$($(this).attr('href')).show();

									return false;
								});
							}

							// what a bug!!?!
							setTimeout(function () {
								$('#navigation__MODULE_ID__').show();
							}, 1);
						}
					});
				</script>
			</div>
		]]>
	</Content> 
</Module>
